% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zbmicat.R
\name{zbmicat}
\alias{zbmicat}
\title{Classify BMI using IOTF cutoffs (Stata zbmicat replication)}
\usage{
zbmicat(
  bmi,
  age,
  gender,
  male_code = 1,
  female_code = 2,
  ageunit = "year",
  wtabbr = FALSE,
  return = "string"
)
}
\arguments{
\item{bmi}{Numeric vector. Body Mass Index values (kg/m²)}

\item{age}{Numeric vector. Age values (same length as bmi)}

\item{gender}{Numeric or character vector. Gender codes (same length as bmi)}

\item{male_code}{Scalar. Code used for males in the gender variable (default: 1)}

\item{female_code}{Scalar. Code used for females in the gender variable (default: 2)}

\item{ageunit}{Character. Units for age values. One of "year", "month", "week", "day" (default: "year")}

\item{wtabbr}{Logical. If TRUE, returns "Normal wt"; if FALSE, returns "Normal weight" (default: FALSE)}

\item{return}{Character. Output format: "string", "factor", "labelled", "haven", or "numeric" (default: "string")}
}
\value{
Vector of BMI classifications. Format depends on \code{return} parameter:
\itemize{
\item "string": Character vector with category names
\item "factor": Ordered factor with proper level ordering
\item "labelled": Labelled numeric vector with values -3 to 2 (requires labelled package)
\item "haven": Haven-labelled numeric vector with values -3 to 2 (requires haven package)
\item "numeric": Plain numeric vector with values -3 to 2 (no labels)
}
}
\description{
This function replicates the functionality of Stata's zbmicat command,
classifying BMI values into weight categories using International Obesity
Task Force (IOTF) age and sex-specific cutoffs with interpolation.
}
\details{
The function uses IOTF reference data (Cole & Lobstein, 2012) to classify BMI values into:
\itemize{
\item Grade 3 thinness (BMI < 16 equivalent at age 18)
\item Grade 2 thinness (BMI 16-17 equivalent at age 18)
\item Grade 1 thinness (BMI 17-18.5 equivalent at age 18)
\item Normal weight (BMI 18.5-25 equivalent at age 18)
\item Overweight (BMI 25-30 equivalent at age 18)
\item Obese (BMI ≥30 equivalent at age 18)
}

Age and sex-specific cutoffs are calculated using the same interpolation methods
as Stata's zbmicat command:
\itemize{
\item Linear interpolation for ages 2-2.5 and 17.5-18 years
\item Cubic interpolation for ages 2.5-17.5 years
\item No interpolation when age matches reference grid exactly
}

Missing values (NA) are returned for:
\itemize{
\item Missing BMI, age, or gender values
\item BMI ≤ 0
\item Age < 2 or > 18 years
\item Invalid gender codes
}
}
\examples{
# Load test data
data(zanthror_testdata)

# Basic usage - string output
zanthror_testdata$bmi_category <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender
)
table(zanthror_testdata$bmi_category, useNA = "ifany")

# Factor output for statistical analysis
bmi_factor <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender,
  return = "factor"
)
levels(bmi_factor)

# Labelled output
bmi_labelled <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender,
  return = "labelled"
)
labelled::val_labels(bmi_labelled)

# Numeric output (values -3 to 2, no labels)
bmi_numeric <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender,
  return = "numeric"
)
table(bmi_numeric)

# Haven-labelled output
bmi_haven <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender,
  return = "haven"
)
attr(bmi_haven, "labels")

# With character gender codes
zanthror_testdata$gender_char <- ifelse(zanthror_testdata$gender == 1, "M", "F")
result <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = zanthror_testdata$age_years,
  gender = zanthror_testdata$gender_char,
  male_code = "M",
  female_code = "F"
)
table(result)

# Age in months
age_months <- zanthror_testdata$age_years * 12
result_months <- zbmicat(
  bmi = zanthror_testdata$bmi,
  age = age_months,
  gender = zanthror_testdata$gender,
  ageunit = "month"
)
table(result_months)

}
\references{
Cole, T. J., & Lobstein, T. (2012). Extended international (IOTF) body mass index
cut-offs for thinness, overweight and obesity. \emph{Pediatric Obesity}, 7(4), 284-294.

Cole, T. J., Bellizzi, M. C., Flegal, K. M., & Dietz, W. H. (2000). Establishing a
standard definition for child overweight and obesity worldwide: international survey.
\emph{BMJ}, 320(7244), 1240-1243.
}
