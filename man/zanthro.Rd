% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/zanthro.R
\name{zanthro}
\alias{zanthro}
\title{Calculate Z-scores for anthropometric measures in children and adolescents}
\usage{
zanthro(
  measure,
  xvar,
  chart,
  version,
  gender,
  male_code = NULL,
  female_code = NULL,
  ageunit = "year",
  gestage = NULL,
  nocutoff = FALSE
)
}
\arguments{
\item{measure}{Numeric vector of anthropometric measurements (e.g., height, weight, BMI)}

\item{xvar}{Numeric vector of the x-variable (usually age, but can be length/height for
weight-for-length/height charts). Units specified by ageunit parameter.}

\item{chart}{Character string specifying the growth chart code. Valid options:
\itemize{
\item \strong{Length/Height charts:} "la" (length-for-age), "ha" (height-for-age)
\item \strong{Weight charts:} "wa" (weight-for-age), "wl" (weight-for-length),
"wh" (weight-for-height)
\item \strong{BMI charts:} "ba" (BMI-for-age)
\item \strong{Head circumference:} "hca" (head circumference-for-age)
\item \strong{UK-specific charts:} "sha" (sitting height-for-age), "lla" (leg length-for-age),
"wsa" (waist-for-age), "bfa" (body fat-for-age)
\item \strong{WHO skinfolds:} "aca" (arm circumference-for-age), "ssa" (subscapular skinfold-for-age),
"tsa" (triceps skinfold-for-age)
}}

\item{version}{Character string specifying the reference population. Valid options:
\itemize{
\item "US" - 2000 CDC Growth Reference
\item "UK" - British 1990 Growth Reference
\item "WHO" - WHO Child Growth Standards (0-5y) + WHO Reference 2007 (5-19y)
\item "UKWHOpreterm" - UK-WHO composite for preterm births
\item "UKWHOterm" - UK-WHO composite for term births (37-42 weeks gestation)
}}

\item{gender}{Vector (string or numeric) indicating gender for each observation}

\item{male_code}{The code used for males in the gender variable (e.g., "M", "Male", 1, "m")}

\item{female_code}{The code used for females in the gender variable (e.g., "F", "Female", 2, "f")}

\item{ageunit}{Character string specifying age units when xvar represents age.
Options: "day", "week", "month", "year" (default). Not used for weight-for-length/height charts.
Conversions: 1 year = 12 months = 365.25/7 weeks = 365.25 days}

\item{gestage}{Numeric vector of gestational ages in weeks (optional). Enables age adjustment
for gestational age. Default assumption is 40 weeks. Ages are corrected by (gestage-40) weeks.
Warning given if any gestational age > 42 weeks. Only valid for age-based charts.}

\item{nocutoff}{Logical. If FALSE (default), z-scores with absolute values ≥5 are set to NA
to flag potential data entry errors. If TRUE, all z-scores are returned regardless of magnitude.}
}
\value{
Numeric vector of z-scores with the same length as the input measure vector.
NA values indicate: age out of range, missing gender, gestational age placing corrected
age out of range, non-positive measurements, or |z-score| ≥ 5 (unless nocutoff=TRUE).
}
\description{
This function calculates z-scores for anthropometric measurements using the LMS method
and reference data from various growth charts: 2000 CDC Growth Reference, British 1990
Growth Reference, WHO Child Growth Standards, WHO Reference 2007, UK-WHO Preterm Growth
Reference, and UK-WHO Term Growth Reference.
}
\details{
\strong{Chart-Version Compatibility:}
\itemize{
\item UK charts only: "sha", "lla", "wsa", "bfa"
\item US/WHO charts only: "wl", "wh"
\item WHO charts only: "aca", "ssa", "tsa"
\item US charts only: "la"
\item Other charts available in multiple versions
}

\strong{Age Ranges by Chart and Version:}
\itemize{
\item \strong{US CDC 2000:} la (0-35.5 months), ha (2-20 years), wa (0-20 years),
ba (2-20 years), hca (0-36 months), wl (45-103.5 cm), wh (77-121.5 cm)
\item \strong{UK 1990:} ha (0-23 years), wa (0-23 years), ba (0-23 years),
hca (0-18y males, 0-17y females), sha (0-23 years), lla (0-23 years),
wsa (3-17 years), bfa (4.75-19.83 years)
\item \strong{WHO:} ha (0-19 years), wa (0-10 years), ba (0-19 years),
hca (0-5 years), aca/ssa/tsa (0.25-5 years), wl (45-110 cm), wh (65-120 cm)
\item \strong{UK-WHO:} ha/wa (0-20 years), ba (0.038-20 years),
hca (0-18y males, 0-17y females)
}

\strong{Measurement Units:}
Length/height: cm, Weight: kg, BMI: kg/m², Head circumference: cm,
Sitting height: cm, Leg length: cm, Waist: cm, Body fat: \%,
Arm circumference: cm, Skinfolds: mm
}
\examples{
# Load the test dataset
data(zanthror_testdata)

# Basic weight-for-age z-scores using WHO charts
z_wa <- zanthro(measure = zanthror_testdata$weight_kg,
               xvar = zanthror_testdata$age_years,
               chart = "wa",
               version = "WHO",
               gender = zanthror_testdata$gender_label,
               male_code = "Male",
               female_code = "Female")

# Height-for-age with numeric gender codes
z_ha <- zanthro(measure = zanthror_testdata$height_cm,
               xvar = zanthror_testdata$age_years,
               chart = "ha",
               version = "WHO",
               gender = zanthror_testdata$gender,
               male_code = 1,
               female_code = 2)

# BMI-for-age using UK charts with auto-detection of gender codes
z_bmi <- zanthro(measure = zanthror_testdata$bmi,
                xvar = zanthror_testdata$age_years,
                chart = "ba",
                version = "UK",
                gender = zanthror_testdata$gender_label)  # Auto-detects Male/Female

# Head circumference-for-age using US charts, subset of young children
young_children <- zanthror_testdata$age_years <= 3
z_hc <- zanthro(measure = zanthror_testdata$head_circumference_cm[young_children],
               xvar = zanthror_testdata$age_years[young_children],
               chart = "hca",
               version = "US",
               gender = zanthror_testdata$gender_label[young_children],
               male_code = "Male",
               female_code = "Female")

# Weight-for-height (xvar is height, not age)
z_wh <- zanthro(measure = zanthror_testdata$weight_kg,
               xvar = zanthror_testdata$height_cm,
               chart = "wh",
               version = "WHO",
               gender = zanthror_testdata$gender_label,
               male_code = "Male",
               female_code = "Female")

# WHO skinfold measurements for young children
young_subset <- zanthror_testdata$age_years <= 5
z_triceps <- zanthro(measure = zanthror_testdata$triceps_skinfold_mm[young_subset],
                    xvar = zanthror_testdata$age_years[young_subset],
                    chart = "tsa",
                    version = "WHO",
                    gender = zanthror_testdata$gender_label[young_subset],
                    male_code = "Male",
                    female_code = "Female")

# UK-specific measurements (sitting height)
# Note: Only available for UK participants in the dataset
uk_participants <- !is.na(zanthror_testdata$sitting_height_cm)
z_sitting <- zanthro(measure = zanthror_testdata$sitting_height_cm[uk_participants],
                    xvar = zanthror_testdata$age_years[uk_participants],
                    chart = "sha",
                    version = "UK",
                    gender = zanthror_testdata$gender_label[uk_participants],
                    male_code = "Male",
                    female_code = "Female")

# Including extreme values (no cutoff)
z_wa_nocutoff <- zanthro(measure = zanthror_testdata$weight_kg,
                        xvar = zanthror_testdata$age_years,
                        chart = "wa",
                        version = "WHO",
                        gender = zanthror_testdata$gender_label,
                        male_code = "Male",
                        female_code = "Female",
                        nocutoff = TRUE)

# Add z-scores directly to the dataset
zanthror_testdata$z_weight_who <- zanthro(
  measure = zanthror_testdata$weight_kg,
  xvar = zanthror_testdata$age_years,
  chart = "wa",
  version = "WHO",
  gender = zanthror_testdata$gender_label,
  male_code = "Male",
  female_code = "Female"
)

}
